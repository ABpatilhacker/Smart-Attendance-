<!DOCTYPE html>
<html>
<head>
  <title>Teacher</title>
  <link rel="stylesheet" href="style.css">

  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
  <script src="firebase.js"></script>
</head>
<body>

<div class="sidebar">
  <h2>ğŸ‘¨â€ğŸ« Teacher</h2>
  <a href="index.html">ğŸ  Home</a>
  <a href="login.html">ğŸšª Logout</a>
</div>

<div class="main-content">

  <div class="card">
    <h3>Create Class</h3>
    <input id="className" placeholder="Class Name">
    <button class="btn btn-primary" onclick="createClass()">Create</button>
  </div>

  <div class="card">
    <h3>Add Student</h3>
    <input id="roll" placeholder="Roll No">
    <input id="sname" placeholder="Student Name">
    <button class="btn btn-primary" onclick="addStudent()">Add</button>
  </div>

  <div class="card">
    <h3>Attendance</h3>
    <div id="students"></div>
  </div>

</div>

<script>
let currentClass = "";

function createClass() {
  currentClass = className.value;
  alert("Class Selected: " + currentClass);
}

function addStudent() {
  database.ref(`classes/${currentClass}/students/${roll.value}`)
    .set(sname.value);
  loadStudents();
}

function loadStudents() {
  students.innerHTML = "";
  database.ref(`classes/${currentClass}/students`).once("value", snap => {
    snap.forEach(s => {
      students.innerHTML += `
        <div class="list-item">
          ${s.key} - ${s.val()}
          <div>
            <button class="btn btn-present" onclick="mark('${s.key}','P')">P</button>
            <button class="btn btn-absent" onclick="mark('${s.key}','A')">A</button>
          </div>
        </div>`;
    });
  });
}

function mark(roll, status) {
  const date = new Date().toISOString().split("T")[0];
  database.ref(`classes/${currentClass}/attendance/${date}/${roll}`)
    .set(status);
}
</script>

</body>
</html>
